<div align="center">

# 🎵 TranMusic 视频音频提取与处理工具 🎵

<img src="https://github.com/liuwang2000/TranYoyiMusic/Yoyi.png" alt="Yoyi" width="180"/>

![版本](https://img.shields.io/badge/版本-1.0-blue)
![许可证](https://img.shields.io/badge/许可证-MIT-yellow)
![Python](https://img.shields.io/badge/Python-3.8+-green)

</div>

## 📝 项目介绍

TranMusic 是一款专为音乐学习与整理设计的工具，可以轻松从视频中提取音频并进行管理。本工具支持从视频文件中提取音频、设置元数据（如作者、专辑、日期等）、剪辑音频片段，并自动整理归档文件。

## ✨ 主要功能

- **🎧 音频提取**：从视频文件中提取高质量MP3音频
- **📋 元数据设置**：为音频文件添加作者、专辑、标题、日期等信息
- **✂️ 音频剪辑**：精确剪辑音频的起止时间
- **🗃️ 自动归档**：处理完成的文件自动归档备份
- **📊 日志记录**：详细记录所有文件处理操作

## 🔧 环境要求

- 💻 Windows 操作系统
- 🐍 Python 3.8 或更高版本
- 🎞️ FFmpeg（可通过安装脚本自动安装）

## 🚀 快速开始

### 🔍 安装 FFmpeg

- **自动安装**：双击运行 `install_ffmpeg.bat` 即可完成安装
- **手动安装**：
  1. 访问 [FFmpeg官方网站](https://www.gyan.dev/ffmpeg/builds/) 下载完整版FFmpeg
  2. 解压到 `C:\Program Files\FFmpeg`
  3. 添加环境变量：右键【此电脑】→【属性】→【高级系统设置】→【环境变量】→ 在Path变量中添加 `C:\Program Files\FFmpeg\bin`

### 📹 从视频提取音频

1. 双击运行 `starTran.bat` 或在命令行中执行 `python process_videos.py`
2. 根据提示输入视频文件路径（可直接拖放文件到窗口）
3. 输入音乐名称与日期信息
4. 系统自动处理并保存MP3文件到music目录

### ✂️ 剪辑音频

1. 双击运行 `starTrim.bat` 或在命令行中执行 `python trim_audio.py`
2. 根据提示输入MP3文件路径（可直接拖放文件到窗口）
3. 输入剪辑起始和结束时间（支持秒数或分:秒格式）
4. 系统自动备份原文件并生成剪辑后的新文件

## 📖 使用详解

### 🔄 视频转音频工作流程

```
[视频文件] → 输入到程序 → 设置音乐名称与日期 → 生成MP3 → 原视频自动归档
```

### ✂️ 音频剪辑工作流程

```
[MP3文件] → 输入到程序 → 设置起止时间 → 生成剪辑后的MP3 → 原文件自动备份
```

### 📋 输入规范

1. **📹 视频文件**：支持MP4、AVI、MOV等常见格式
2. **🎵 音乐命名**：支持中英文混合，如"月光奏鸣曲"或"Moonlight_Sonata"
3. **📅 日期格式**：
   - 支持格式：2024.03.27、2024-03-27、2024年3月27日等
   - 系统自动标准化为8位数字（例：20240327）
4. **⏱️ 剪辑时间**：
   - 支持秒数（如：120）或分:秒格式（如：2:30）
   - 输入0表示不剪切该端点

## 📂 目录结构

```
TranMusic/
├── videos/         # 待处理视频存放目录
│   └── old/        # 处理后视频归档目录
├── music/          # 生成的MP3文件目录
│   └── old/        # 历史音频备份目录
├── directory.log   # 操作日志记录
├── process_videos.py  # 视频处理主脚本
├── trim_audio.py      # 音频剪辑工具
├── starTran.bat       # 启动视频处理脚本
├── starTrim.bat       # 启动音频剪辑脚本
├── install_ffmpeg.bat # FFmpeg安装脚本
└── config.ini         # 配置文件（存储作者、专辑信息）
```

## ❓ 常见问题与解决方案

### 🚫 未检测到 FFmpeg
- 运行 `install_ffmpeg.bat` 自动安装
- 或按上述步骤手动配置环境变量
- 重启命令行窗口后再次尝试

### 📅 日期格式错误
- 确保输入格式如：2024.03.27、2024-03-27
- 系统会自动处理为标准格式

### ⏱️ 剪辑时间格式错误
- 检查时间格式是否为秒数（如120）或分:秒格式（如2:30）
- 确保起始时间小于结束时间
- 输入0表示不剪切该端点

### ❌ 文件处理失败
- 确保文件路径不包含特殊字符
- 检查磁盘剩余空间是否充足（建议>500MB）
- 确保文件未被其他程序占用

## ⚠️ 使用注意事项

- 视频文件路径最好不要包含中文和特殊符号
- 处理过程中不要关闭命令行窗口
- 每次运行会自动将现有文件归档备份
- 所有操作都会记录在日志文件中

## 📝 更新日志

- 2024.03.31 初始版本发布

---

<div align="center">

### 使用步骤示意图

<img src="Yoyi.png" alt="Yoyi使用示例" width="250"/>

© 2024 TranMusic - 用❤️制作

</div>